# Default values for chronos-kubernetes-scheduler
# This is a YAML-formatted file that declares variables to be passed into templates

# -- Global configuration
global:
  # -- Global image registry override
  imageRegistry: ""
  # -- Global image pull secrets
  imagePullSecrets: []

# -- Image configuration  
image:
  # -- Image registry
  registry: ghcr.io
  # -- Image repository
  repository: rohitraut3366/chronos-kubernetes-scheduler
  # -- Image tag (defaults to chart appVersion if not set)
  tag: latest
  # -- Image pull policy
  pullPolicy: IfNotPresent

# -- Image pull secrets for private registries
imagePullSecrets: []

# -- Override the name of the chart
nameOverride: ""

# -- Override the full name of the resources
fullnameOverride: ""

# -- Number of scheduler replicas (3 for HA with leader election)
replicaCount: 3

# -- Scheduler configuration
scheduler:
  # -- Scheduler name (must match the schedulerName in pods)
  name: chronos-kubernetes-scheduler
  # -- Profile name to use from profiles section
  profileName: "chronos-optimized"

# -- Scheduler profiles - define multiple configurations and switch between them
profiles:
  # -- Default Chronos profile: Time-based scheduling with resource tie-breaking
  chronos-optimized:
    plugins:
      queueSort:
        enabled:
        - name: Chronos
        disabled:
        - name: "*"
      score:
        enabled:
        - name: Chronos
          weight: 100
        - name: NodeResourcesFit
          weight: 1
        disabled:
        - name: "*"
      multiPoint:
        enabled:
        - name: NodeResourcesFit
          weight: 1
    pluginConfig:
    - name: Chronos
    - name: NodeResourcesFit
      args:
        apiVersion: kubescheduler.config.k8s.io/v1
        kind: NodeResourcesFitArgs
        scoringStrategy:
          type: MostAllocated
          resources:
          - name: cpu
            weight: 1
          - name: memory
            weight: 1

  # Only for simulation testing - DO NOT USE IN PRODUCTION
  chronos-optimized-queue-sort-reserve:
    plugins:
      queueSort:
        enabled:
        - name: Chronos
        disabled:
        - name: "*"
      score:
        enabled:
        - name: Chronos
          weight: 100
        - name: NodeResourcesFit
          weight: 1
        disabled:
        - name: "*"
      reserve:
        enabled:
        - name: Chronos
      multiPoint:
        enabled:
        - name: NodeResourcesFit
          weight: 1
    pluginConfig:
    - name: Chronos
    - name: NodeResourcesFit
      args:
        apiVersion: kubescheduler.config.k8s.io/v1
        kind: NodeResourcesFitArgs
        scoringStrategy:
          type: MostAllocated
          resources:
          - name: cpu
            weight: 1
          - name: memory
            weight: 1

# -- Service account configuration
serviceAccount:
  # -- Specifies whether a service account should be created
  create: true
  # -- Annotations to add to the service account
  annotations: {}
  # -- The name of the service account to use
  name: ""

# -- RBAC configuration
rbac:
  # -- Specifies whether RBAC resources should be created
  create: true
  # -- Additional rules to add to the cluster role
  rules: []

# -- Security context for pods
podSecurityContext:
  # -- Run as non-root user
  runAsNonRoot: true
  # -- User ID to run containers
  runAsUser: 65532
  # -- Group ID to run containers  
  runAsGroup: 65532
  # -- FSGroup for volume permissions
  fsGroup: 65532

# -- Security context for containers
securityContext:
  # -- Allow privilege escalation
  allowPrivilegeEscalation: false
  # -- Run as non-root
  runAsNonRoot: true
  # -- User ID
  runAsUser: 65532
  # -- Read-only root filesystem
  readOnlyRootFilesystem: true
  # -- Capabilities
  capabilities:
    drop:
      - ALL

# -- Resource limits and requests
resources:
  limits:
    cpu: 2
    memory: 4Gi
  requests:
    cpu: 2
    memory: 4Gi

# -- Node selector for scheduler placement
nodeSelector:
  kubernetes.io/os: linux

# -- Tolerations for scheduler pods
tolerations:
  # -- Tolerate control-plane taints
  - key: node-role.kubernetes.io/control-plane
    operator: Exists
    effect: NoSchedule

# -- Affinity rules for scheduler placement  
affinity: {}

# -- Pod disruption budget
podDisruptionBudget:
  # -- Enable pod disruption budget
  enabled: true
  # -- Minimum available pods
  minAvailable: 1
  # -- Maximum unavailable pods (alternative to minAvailable)
  maxUnavailable: ""



# -- Probes configuration
probes:
  # -- Liveness probe settings
  liveness:
    # -- Enable liveness probe
    enabled: true
    # -- Initial delay before probing
    initialDelaySeconds: 30
    # -- Probe period
    periodSeconds: 30
    # -- Probe timeout
    timeoutSeconds: 5
    # -- Success threshold
    successThreshold: 1
    # -- Failure threshold
    failureThreshold: 3
  
  # -- Readiness probe settings
  readiness:
    # -- Enable readiness probe
    enabled: true
    # -- Initial delay before probing
    initialDelaySeconds: 15
    # -- Probe period
    periodSeconds: 10
    # -- Probe timeout
    timeoutSeconds: 3
    # -- Success threshold
    successThreshold: 1
    # -- Failure threshold
    failureThreshold: 2

# -- Logging configuration
logging:
  # -- Log verbosity level (0-10)
  level: 2
  # -- Log format (text or json)
  format: text

# -- Metrics and monitoring
metrics:
  # -- Enable metrics endpoint
  enabled: true
  # -- Metrics port
  port: 10259
  # -- ServiceMonitor for Prometheus
  serviceMonitor:
    # -- Create ServiceMonitor
    enabled: false
    # -- Additional labels
    labels: {}
    # -- Scrape interval
    interval: 30s
    # -- Scrape timeout
    scrapeTimeout: 10s

# -- Pod annotations
podAnnotations: {}

# -- Pod labels
podLabels: {}

# -- Deployment strategy
strategy:
  type: RollingUpdate
  rollingUpdate:
    maxSurge: 1
    maxUnavailable: 0

# -- Additional environment variables
extraEnv: []
  # - name: CUSTOM_ENV_VAR
  #   value: "custom-value"

# -- Additional volumes
extraVolumes: []
  # - name: custom-config
  #   configMap:
  #     name: custom-config

# -- Additional volume mounts
extraVolumeMounts: []
  # - name: custom-config
  #   mountPath: /etc/custom
  #   readOnly: true

# -- Additional containers (sidecars)
extraContainers: []
  # - name: sidecar
  #   image: sidecar:latest

# -- Init containers
initContainers: []
  # - name: init-container
  #   image: init:latest

# -- Priority class for scheduler pods
priorityClassName: system-cluster-critical

# -- Restart policy
restartPolicy: Always

# -- Termination grace period
terminationGracePeriodSeconds: 30
